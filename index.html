<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Habit Builder - Blueprint Season</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f3f7;
    margin: 20px;
    color: #333;
  }
  h1, h2, h3 {
    text-align: center;
    color: #2c3e50;
  }
  table {
    width: 100%;
    max-width: 700px;
    margin: 20px auto;
    border-collapse: collapse;
    background: #fff;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  th, td {
    padding: 12px 15px;
    border-bottom: 1px solid #ddd;
    text-align: left;
  }
  th {
    background-color: #2980b9;
    color: white;
  }
  .tag {
    font-weight: bold;
    padding: 3px 8px;
    border-radius: 12px;
    color: white;
    font-size: 0.85em;
  }
  .Health { background-color: #27ae60; }
  .Trading { background-color: #c0392b; }
  .Mindset { background-color: #8e44ad; }
  .Growth { background-color: #f39c12; }
  .Career { background-color: #16a085; }
  .Finance { background-color: #d35400; }
  .Spirit { background-color: #2980b9; }
  .Planning { background-color: #34495e; }

  .container {
    max-width: 700px;
    margin: 0 auto 40px auto;
  }

  .weekly-bonus {
    background: #ecf0f1;
    padding: 15px 25px;
    border-radius: 8px;
    margin: 30px auto;
    max-width: 700px;
  }
  .weekly-bonus div {
    margin-bottom: 10px;
  }

  .xp-summary {
    max-width: 700px;
    margin: 20px auto;
    background: #dff0d8;
    border-radius: 8px;
    padding: 15px 25px;
    color: #3c763d;
    box-shadow: 0 0 10px rgba(60, 118, 61, 0.2);
  }
  #rewards-list {
    list-style: none;
    padding-left: 0;
  }
  #rewards-list li {
    margin-bottom: 8px;
  }
</style>
</head>
<body>

<h1>Blueprint Season - Habit Builder</h1>

<div class="container">
  <table>
    <thead>
      <tr><th>Done?</th><th>Quest</th><th>XP</th><th>Tag</th></tr>
    </thead>
    <tbody id="daily-quests-tbody">
      <!-- Daily quests inserted by JS -->
    </tbody>
  </table>
</div>

<div class="weekly-bonus">
  <h2>Weekly Bonus Quests</h2>
  <div>
    <input type="checkbox" class="weekly-bonus-quest" data-xp="50" id="bonus-5R" />
    <label for="bonus-5R">Hit 5R trading profit goal (50 XP)</label>
  </div>
  <div>
    <input type="checkbox" class="weekly-bonus-quest" data-xp="40" id="bonus-clean-meals" />
    <label for="bonus-clean-meals">Full week of clean meals (40 XP)</label>
  </div>
  <div>
    <input type="checkbox" class="weekly-bonus-quest" data-xp="35" id="bonus-morning-walk" />
    <label for="bonus-morning-walk">Daily morning walk for 7 days (35 XP)</label>
  </div>
  <div>
    <input type="checkbox" class="weekly-bonus-quest" data-xp="45" id="bonus-python-study" />
    <label for="bonus-python-study">Study Python/backend 3+ hours total (45 XP)</label>
  </div>
  <div>
    <input type="checkbox" class="weekly-bonus-quest" data-xp="30" id="bonus-trade-journal" />
    <label for="bonus-trade-journal">Complete full trading journal daily (30 XP)</label>
  </div>
  <div>
    <input type="checkbox" class="weekly-bonus-quest" data-xp="20" id="bonus-connect" />
    <label for="bonus-connect">Connect with friends/family 5x this week (20 XP)</label>
  </div>
</div>

<div class="xp-summary">
  <h2>Total XP: <span id="total-xp">0</span></h2>
  <h3>Unlocked Rewards:</h3>
  <ul id="rewards-list">
    <!-- Unlocked rewards shown here -->
  </ul>
</div>

<script>
  // Define daily quests
  const dailyQuests = [
    { quest: "Morning walk (min 20 mins)", xp: 5, tag: "Health" },
    { quest: "Pre-trading self-check (focus, sleep, stress)", xp: 7, tag: "Trading" },
    { quest: "Take a live trade (based on plan)", xp: 10, tag: "Trading" },
    { quest: "Log trade + emotion in journal", xp: 5, tag: "Trading" },
    { quest: "Do backtesting or refine strategy", xp: 6, tag: "Trading" },
    { quest: "Emotional reflection or meditation", xp: 4, tag: "Mindset" },
    { quest: "Eat 3 clean meals", xp: 5, tag: "Health" },
    { quest: "Spend 1hr improving strategy playbook", xp: 7, tag: "Growth" },
    { quest: "Study 30+ mins of Python/backend", xp: 5, tag: "Career" },
    { quest: "Update your Money Map", xp: 4, tag: "Finance" },
    { quest: "Connect with a friend or family member", xp: 3, tag: "Spirit" },
    { quest: "Read 10+ mins (book or trading)", xp: 3, tag: "Growth" },
    { quest: "Plan your next day (tasks, focus)", xp: 4, tag: "Planning" },
  ];

  // Big rewards thresholds and names
  const rewards = [
    { name: "ðŸ« Treat Yourself", xpRequired: 30 },
    { name: "ðŸš¶ Extra Walk", xpRequired: 40 },
    { name: "ðŸŽ® Game Time", xpRequired: 50 },
    { name: "ðŸ› Self-Care Bath", xpRequired: 60 },
    { name: "ðŸ½ï¸ Eat Out", xpRequired: 80 },
    { name: "ðŸ›ï¸ Small Purchase", xpRequired: 70 },
    { name: "ðŸ‘Ÿ New Trainers", xpRequired: 200 },
    { name: "âœˆï¸ Weekend Solo Trip", xpRequired: 400 },
  ];

  const dailyQuestsTbody = document.getElementById('daily-quests-tbody');
  const totalXpElem = document.getElementById('total-xp');
  const rewardsListElem = document.getElementById('rewards-list');

  // Load saved state from localStorage or init new
  let savedData = JSON.parse(localStorage.getItem('habitBuilderData')) || {
    daily: Array(dailyQuests.length).fill(false),
    weekly: {},
  };

  // Render daily quests
  function renderDailyQuests() {
    dailyQuestsTbody.innerHTML = '';
    dailyQuests.forEach((q, i) => {
      const tr = document.createElement('tr');

      const tdCheckbox = document.createElement('td');
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.classList.add('daily-quest');
      checkbox.dataset.index = i;
      checkbox.checked = savedData.daily[i];
      tdCheckbox.appendChild(checkbox);

      const tdQuest = document.createElement('td');
      tdQuest.textContent = q.quest;

      const tdXp = document.createElement('td');
      tdXp.textContent = q.xp + ' XP';

      const tdTag = document.createElement('td');
      const spanTag = document.createElement('span');
      spanTag.classList.add('tag', q.tag);
      spanTag.textContent = q.tag;
      tdTag.appendChild(spanTag);

      tr.appendChild(tdCheckbox);
      tr.appendChild(tdQuest);
      tr.appendChild(tdXp);
      tr.appendChild(tdTag);

      dailyQuestsTbody.appendChild(tr);
    });
  }

  // Load weekly bonuses checkboxes state
  function loadWeeklyBonuses() {
    const weeklyCheckboxes = document.querySelectorAll('.weekly-bonus-quest');
    weeklyCheckboxes.forEach(cb => {
      cb.checked = savedData.weekly[cb.id] || false;
    });
  }

  // Calculate total XP from daily and weekly
  function calculateTotalXp() {
    let total = 0;
    // daily XP
    savedData.daily.forEach((done, i) => {
      if (done) total += dailyQuests[i].xp;
    });
    // weekly XP
    const weeklyCheckboxes = document.querySelectorAll('.weekly-bonus-quest');
    weeklyCheckboxes.forEach(cb => {
      if (cb.checked) total += parseInt(cb.dataset.xp, 10);
    });
    return total;
  }

  // Update XP display and rewards
  function updateXpAndRewards() {
    const totalXp = calculateTotalXp();
    totalXpElem.textContent = totalXp;

    // Show unlocked rewards
    rewardsListElem.innerHTML = '';
    rewards
      .filter(r => totalXp >= r.xpRequired)
      .forEach(r => {
        const li = document.createElement('li');
        li.textContent = `${r.name} â€” unlocked at ${r.xpRequired} XP`;
        rewardsListElem.appendChild(li);
      });
  }

  // Save current progress to localStorage
  function saveProgress() {
    // daily
    const dailyCheckboxes = document.querySelectorAll('.daily-quest');
    dailyCheckboxes.forEach(cb => {
      const index = parseInt(cb.dataset.index, 10);
      savedData.daily[index] = cb.checked;
    });

    // weekly
    const weeklyCheckboxes = document.querySelectorAll('.weekly-bonus-quest');
    weeklyCheckboxes.forEach(cb => {
      savedData.weekly[cb.id] = cb.checked;
    });

    localStorage.setItem('habitBuilderData', JSON.stringify(savedData));
  }

  // Event listeners for checkboxes
  function addEventListeners() {
    document.addEventListener('change', e => {
      if (e.target.matches('.daily-quest') || e.target.matches('.weekly-bonus-quest')) {
        saveProgress();
        updateXpAndRewards();
      }
    });
  }

  // Initial render and setup
  renderDailyQuests();
  loadWeeklyBonuses();
  updateXpAndRewards();
  addEventListeners();

</script>

</body>
</html>
